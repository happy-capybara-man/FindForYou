<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¨­å®š | æ—¥å¸¸ç‰©å“æœå°‹åŠ©æ‰‹</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
        }
        .back-btn {
            background: rgba(255,255,255,0.1);
            border: none;
            color: #fff;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .back-btn:hover { background: rgba(255,255,255,0.2); }
        h1 { font-size: 24px; }
        
        .card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
        }
        .card h2 {
            font-size: 18px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .camera-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .camera-item {
            display: grid;
            grid-template-columns: 80px 1fr 1fr auto;
            gap: 12px;
            align-items: center;
            padding: 16px;
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
        }
        .camera-id {
            font-weight: bold;
            color: #38ef7d;
        }
        input, select {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: #fff;
            padding: 10px 14px;
            border-radius: 8px;
            font-size: 14px;
            width: 100%;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #38ef7d;
        }
        input::placeholder { color: rgba(255,255,255,0.5); }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
        }
        .btn-primary {
            background: linear-gradient(135deg, #38ef7d, #11998e);
            color: #fff;
        }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(56,239,125,0.4); }
        .btn-danger {
            background: #f5576c;
            color: #fff;
        }
        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #fff;
        }
        
        .add-camera-form {
            display: grid;
            grid-template-columns: 100px 1fr 1fr auto;
            gap: 12px;
            padding: 16px;
            background: rgba(56,239,125,0.1);
            border-radius: 12px;
            border: 2px dashed rgba(56,239,125,0.3);
            margin-top: 16px;
        }
        
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #38ef7d;
            color: #000;
            padding: 12px 24px;
            border-radius: 8px;
            animation: slideIn 0.3s ease;
        }
        @keyframes slideIn {
            from { transform: translateY(100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .status {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
        }
        .status.active { background: rgba(56,239,125,0.2); color: #38ef7d; }
        .status.inactive { background: rgba(245,87,108,0.2); color: #f5576c; }
        
        .preview-modal {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .preview-content {
            background: rgba(30,30,50,0.95);
            border-radius: 16px;
            padding: 20px;
            max-width: 90%;
            text-align: center;
        }
        .preview-content img {
            max-width: 100%;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        .btn-group {
            display: flex;
            gap: 8px;
        }
        .btn-preview {
            background: #4a90d9;
            color: #fff;
            padding: 8px 12px;
            font-size: 12px;
        }
        
        /* Toggle Switch */
        .switch {
            position: relative;
            width: 60px;
            height: 34px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(245,87,108,0.5);
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: #38ef7d;
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="/" class="back-btn">â† è¿”å›</a>
            <h1>âš™ï¸ è¨­å®š</h1>
        </div>
        
        <div class="card">
            <h2>ğŸ“¹ æ”å½±æ©Ÿé…ç½®</h2>
            <p style="color:#aaa; margin-bottom:20px;">è¨­å®šæ¯å€‹æ”å½±æ©Ÿçš„åç¨±èˆ‡æ‰€åœ¨ä½ç½®ï¼Œåµæ¸¬çµæœæœƒè‡ªå‹•ä½¿ç”¨æ”å½±æ©Ÿä½ç½®ã€‚</p>
            
            <div class="camera-list" id="cameraList">
                <!-- å‹•æ…‹å¡«å…¥ -->
            </div>
            
            <div class="add-camera-form" id="addForm">
                <input type="number" id="newCameraId" placeholder="ç·¨è™Ÿ" min="0" max="10">
                <input type="text" id="newCameraName" placeholder="æ”å½±æ©Ÿåç¨±">
                <input type="text" id="newCameraLocation" placeholder="æ‰€åœ¨ä½ç½®">
                <button class="btn btn-primary" onclick="addCamera()">æ–°å¢</button>
            </div>
        </div>
        
        <div class="card">
            <h2>ğŸ” åµæ¸¬åˆ°çš„æ”å½±æ©Ÿ</h2>
            <p style="color:#aaa; margin-bottom:20px;">ç³»çµ±åµæ¸¬åˆ°çš„å¯ç”¨æ”å½±æ©Ÿæ¸…å–®</p>
            <div id="availableCameras">è¼‰å…¥ä¸­...</div>
        </div>
        
        <div class="card">
            <h2>ğŸ·ï¸ åµæ¸¬é¡åˆ¥ç®¡ç†</h2>
            <p style="color:#aaa; margin-bottom:20px;">è¨­å®š YOLO-World è¦åµæ¸¬çš„ç‰©å“é¡åˆ¥åŠä¸­æ–‡åç¨±</p>
            
            <div id="classList" style="display:flex; flex-wrap:wrap; gap:8px; margin-bottom:20px;">
                <!-- å‹•æ…‹å¡«å…¥ -->
            </div>
            
            <div style="display:grid; grid-template-columns: 1fr 1fr auto; gap:12px; padding:16px; background:rgba(100,149,237,0.1); border-radius:12px; border:2px dashed rgba(100,149,237,0.3);">
                <input type="text" id="newClassEn" placeholder="è‹±æ–‡é¡åˆ¥ (å¦‚: laptop)">
                <input type="text" id="newClassZh" placeholder="ä¸­æ–‡åç¨± (å¦‚: ç­†é›»)">
                <button class="btn btn-primary" onclick="addClass()">æ–°å¢é¡åˆ¥</button>
            </div>
            
            <div style="margin-top:15px;">
                <button class="btn btn-secondary" onclick="reloadModel()" style="width:100%;">
                    ğŸ”„ é‡æ–°è¼‰å…¥æ¨¡å‹ï¼ˆå¥—ç”¨æ–°é¡åˆ¥ï¼‰
                </button>
            </div>
        </div>
        
        <div class="card">
            <h2>â±ï¸ è‡ªå‹•åµæ¸¬</h2>
            <p style="color:#aaa; margin-bottom:20px;">å•Ÿç”¨å¾Œç³»çµ±æœƒå®šæ™‚è‡ªå‹•æƒææ”å½±æ©Ÿä¸¦è¨˜éŒ„ç‰©å“ä½ç½®</p>
            
            <div style="display:flex; align-items:center; justify-content:space-between; padding:16px; background:rgba(0,0,0,0.2); border-radius:12px;">
                <div>
                    <span style="font-size:16px;">è‡ªå‹•åµæ¸¬</span>
                    <span id="schedulerStatus" style="margin-left:10px; padding:4px 12px; border-radius:12px; font-size:12px; background:rgba(245,87,108,0.2); color:#f5576c;">å·²åœæ­¢</span>
                </div>
                <label class="switch">
                    <input type="checkbox" id="schedulerSwitch" onchange="toggleScheduler()">
                    <span class="slider"></span>
                </label>
            </div>
            
            <div style="margin-top:15px; display:grid; grid-template-columns: 1fr auto; gap:12px; align-items:center;">
                <label style="color:#aaa;">åµæ¸¬é–“éš”ï¼ˆç§’ï¼‰</label>
                <input type="number" id="intervalInput" value="30" min="5" max="300" style="width:100px; text-align:center;" onchange="setDetectionInterval()">
            </div>
        </div>
        
        <div class="card">
            <h2>â­ å¸¸ç”¨ç‰©å“å¿«æ·</h2>
            <p style="color:#aaa; margin-bottom:20px;">è‡ªè¨‚é¦–é é¡¯ç¤ºçš„å¸¸ç”¨ç‰©å“å¿«æ·æŒ‰éˆ•</p>
            
            <div id="quickItemsList" style="display:flex; flex-wrap:wrap; gap:8px; margin-bottom:20px;">
                <!-- å‹•æ…‹å¡«å…¥ -->
            </div>
            
            <div style="display:grid; grid-template-columns: 1fr 1fr 80px auto; gap:12px; padding:16px; background:rgba(255,215,0,0.1); border-radius:12px; border:2px dashed rgba(255,215,0,0.3);">
                <input type="text" id="newQuickItemName" placeholder="ç‰©å“åç¨±">
                <input type="text" id="newQuickItemIcon" placeholder="åœ–ç¤º (å¦‚: ğŸ“±)">
                <input type="number" id="newQuickItemOrder" placeholder="é †åº" min="1" max="10" value="1">
                <button class="btn btn-primary" onclick="addQuickItem()">æ–°å¢</button>
            </div>
        </div>
    </div>
    
    <script>
        const API_BASE = 'http://localhost:8000';
        
        async function loadConfig() {
            try {
                const res = await fetch(`${API_BASE}/api/cameras/config`);
                const data = await res.json();
                renderCameraList(data.cameras || {});
            } catch (e) {
                console.error('è¼‰å…¥é…ç½®å¤±æ•—', e);
            }
        }
        
        async function loadAvailableCameras() {
            try {
                const res = await fetch(`${API_BASE}/api/cameras`);
                const data = await res.json();
                const container = document.getElementById('availableCameras');
                
                if (data.cameras && data.cameras.length > 0) {
                    container.innerHTML = data.cameras.map(c => 
                        `<span class="status active" style="margin-right:8px;">ğŸ“¹ ${c.name}</span>`
                    ).join('');
                } else {
                    container.innerHTML = '<span style="color:#aaa">æœªåµæ¸¬åˆ°æ”å½±æ©Ÿ</span>';
                }
            } catch (e) {
                document.getElementById('availableCameras').innerHTML = '<span style="color:#f5576c">ç„¡æ³•é€£æ¥å¾Œç«¯</span>';
            }
        }
        
        function renderCameraList(cameras) {
            const container = document.getElementById('cameraList');
            const entries = Object.entries(cameras);
            
            if (entries.length === 0) {
                container.innerHTML = '<p style="color:#aaa;text-align:center;padding:20px;">å°šæœªé…ç½®ä»»ä½•æ”å½±æ©Ÿ</p>';
                return;
            }
            
            container.innerHTML = entries.map(([id, cam]) => `
                <div class="camera-item" data-id="${id}">
                    <span class="camera-id">æ”å½±æ©Ÿ ${id}</span>
                    <input type="text" value="${cam.name}" placeholder="åç¨±" onchange="updateCamera('${id}', 'name', this.value)">
                    <input type="text" value="${cam.location}" placeholder="ä½ç½®" onchange="updateCamera('${id}', 'location', this.value)">
                    <div class="btn-group">
                        <button class="btn btn-preview" onclick="previewCamera('${id}')">ğŸ‘ é è¦½</button>
                        <button class="btn btn-danger" onclick="deleteCamera('${id}')">åˆªé™¤</button>
                    </div>
                </div>
            `).join('');
        }
        
        async function previewCamera(id) {
            showToast('è¼‰å…¥é è¦½ä¸­...');
            
            try {
                const res = await fetch(`${API_BASE}/api/cameras/${id}/preview`);
                const data = await res.json();
                
                if (data.success) {
                    showPreviewModal(id, data.image);
                } else {
                    showToast('ç„¡æ³•å–å¾—é è¦½');
                }
            } catch (e) {
                console.error('é è¦½å¤±æ•—', e);
                showToast('é è¦½å¤±æ•—');
            }
        }
        
        function showPreviewModal(cameraId, imageData) {
            const modal = document.createElement('div');
            modal.className = 'preview-modal';
            modal.innerHTML = `
                <div class="preview-content">
                    <h3 style="margin-bottom:15px;">ğŸ“¹ æ”å½±æ©Ÿ ${cameraId} é è¦½</h3>
                    <img src="${imageData}" alt="é è¦½">
                    <div>
                        <button class="btn btn-secondary" onclick="this.closest('.preview-modal').remove()">é—œé–‰</button>
                        <button class="btn btn-primary" onclick="previewCamera('${cameraId}'); this.closest('.preview-modal').remove();">é‡æ–°æ•´ç†</button>
                    </div>
                </div>
            `;
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.remove();
            });
            
            document.body.appendChild(modal);
        }
        
        async function updateCamera(id, field, value) {
            const item = document.querySelector(`.camera-item[data-id="${id}"]`);
            const name = item.querySelectorAll('input')[0].value;
            const location = item.querySelectorAll('input')[1].value;
            
            await fetch(`${API_BASE}/api/cameras/config`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ camera_id: id, name, location, enabled: true })
            });
            
            showToast('é…ç½®å·²å„²å­˜');
        }
        
        async function addCamera() {
            const id = document.getElementById('newCameraId').value;
            const name = document.getElementById('newCameraName').value || `æ”å½±æ©Ÿ ${id}`;
            const location = document.getElementById('newCameraLocation').value || 'æœªè¨­å®š';
            
            if (!id) { alert('è«‹è¼¸å…¥æ”å½±æ©Ÿç·¨è™Ÿ'); return; }
            
            await fetch(`${API_BASE}/api/cameras/config`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ camera_id: id, name, location, enabled: true })
            });
            
            document.getElementById('newCameraId').value = '';
            document.getElementById('newCameraName').value = '';
            document.getElementById('newCameraLocation').value = '';
            
            showToast('æ”å½±æ©Ÿå·²æ–°å¢');
            loadConfig();
        }
        
        async function deleteCamera(id) {
            if (!confirm(`ç¢ºå®šè¦åˆªé™¤æ”å½±æ©Ÿ ${id} çš„é…ç½®ï¼Ÿ`)) return;
            
            await fetch(`${API_BASE}/api/cameras/config/${id}`, { method: 'DELETE' });
            showToast('é…ç½®å·²åˆªé™¤');
            loadConfig();
        }
        
        function showToast(msg) {
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = msg;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }
        
        // ========================================
        // é¡åˆ¥ç®¡ç†åŠŸèƒ½
        // ========================================
        
        async function loadClasses() {
            try {
                const res = await fetch(`${API_BASE}/api/classes`);
                const data = await res.json();
                renderClassList(data.classes || [], data.class_names_zh || {});
            } catch (e) {
                console.error('è¼‰å…¥é¡åˆ¥å¤±æ•—', e);
            }
        }
        
        function renderClassList(classes, classNamesZh) {
            const container = document.getElementById('classList');
            
            if (classes.length === 0) {
                container.innerHTML = '<p style="color:#aaa;">å°šæœªè¨­å®šä»»ä½•é¡åˆ¥</p>';
                return;
            }
            
            container.innerHTML = classes.map(cls => {
                const zh = classNamesZh[cls] || cls;
                return `
                    <div class="class-tag" style="
                        display: inline-flex;
                        align-items: center;
                        gap: 8px;
                        background: rgba(100,149,237,0.2);
                        padding: 8px 12px;
                        border-radius: 20px;
                        font-size: 14px;
                    ">
                        <span style="color:#6495ed;">${cls}</span>
                        <span style="color:#aaa;">â†’</span>
                        <span style="color:#fff;">${zh}</span>
                        <button onclick="removeClass('${cls}')" style="
                            background: rgba(245,87,108,0.5);
                            border: none;
                            color: #fff;
                            width: 20px;
                            height: 20px;
                            border-radius: 50%;
                            cursor: pointer;
                            font-size: 12px;
                        ">âœ•</button>
                    </div>
                `;
            }).join('');
        }
        
        async function addClass() {
            const en = document.getElementById('newClassEn').value.trim().toLowerCase();
            const zh = document.getElementById('newClassZh').value.trim();
            
            if (!en) {
                alert('è«‹è¼¸å…¥è‹±æ–‡é¡åˆ¥åç¨±');
                return;
            }
            
            try {
                await fetch(`${API_BASE}/api/classes/add`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        class_name: en, 
                        class_name_zh: zh || en 
                    })
                });
                
                document.getElementById('newClassEn').value = '';
                document.getElementById('newClassZh').value = '';
                
                showToast(`å·²æ–°å¢é¡åˆ¥: ${en}`);
                loadClasses();
            } catch (e) {
                console.error('æ–°å¢é¡åˆ¥å¤±æ•—', e);
                showToast('æ–°å¢å¤±æ•—');
            }
        }
        
        async function removeClass(className) {
            if (!confirm(`ç¢ºå®šè¦åˆªé™¤é¡åˆ¥ã€Œ${className}ã€ï¼Ÿ`)) return;
            
            try {
                await fetch(`${API_BASE}/api/classes/${className}`, {
                    method: 'DELETE'
                });
                showToast(`å·²åˆªé™¤é¡åˆ¥: ${className}`);
                loadClasses();
            } catch (e) {
                console.error('åˆªé™¤é¡åˆ¥å¤±æ•—', e);
            }
        }
        
        async function reloadModel() {
            showToast('æ­£åœ¨é‡æ–°è¼‰å…¥æ¨¡å‹...');
            
            try {
                const res = await fetch(`${API_BASE}/api/classes/reload`, {
                    method: 'POST'
                });
                const data = await res.json();
                
                if (data.success) {
                    showToast('æ¨¡å‹å·²é‡æ–°è¼‰å…¥ï¼');
                } else {
                    showToast('é‡æ–°è¼‰å…¥å¤±æ•—');
                }
            } catch (e) {
                console.error('é‡æ–°è¼‰å…¥å¤±æ•—', e);
                showToast('é‡æ–°è¼‰å…¥å¤±æ•—');
            }
        }
        
        // ========================================
        // è‡ªå‹•åµæ¸¬æ§åˆ¶
        // ========================================
        
        async function loadSchedulerStatus() {
            try {
                const res = await fetch(`${API_BASE}/api/health`);
                const data = await res.json();
                
                const switchEl = document.getElementById('schedulerSwitch');
                const statusEl = document.getElementById('schedulerStatus');
                
                if (data.scheduler_running) {
                    switchEl.checked = true;
                    statusEl.style.background = 'rgba(56,239,125,0.2)';
                    statusEl.style.color = '#38ef7d';
                    statusEl.textContent = 'é‹è¡Œä¸­';
                } else {
                    switchEl.checked = false;
                    statusEl.style.background = 'rgba(245,87,108,0.2)';
                    statusEl.style.color = '#f5576c';
                    statusEl.textContent = 'å·²åœæ­¢';
                }
            } catch (e) {
                console.error('è¼‰å…¥æ’ç¨‹å™¨ç‹€æ…‹å¤±æ•—', e);
            }
        }
        
        async function toggleScheduler() {
            const switchEl = document.getElementById('schedulerSwitch');
            const statusEl = document.getElementById('schedulerStatus');
            const action = switchEl.checked ? 'start' : 'stop';
            
            try {
                const res = await fetch(`${API_BASE}/api/scheduler/${action}`, {
                    method: 'POST'
                });
                const data = await res.json();
                
                if (data.success) {
                    if (switchEl.checked) {
                        statusEl.style.background = 'rgba(56,239,125,0.2)';
                        statusEl.style.color = '#38ef7d';
                        statusEl.textContent = 'é‹è¡Œä¸­';
                        showToast('è‡ªå‹•åµæ¸¬å·²å•Ÿå‹•');
                    } else {
                        statusEl.style.background = 'rgba(245,87,108,0.2)';
                        statusEl.style.color = '#f5576c';
                        statusEl.textContent = 'å·²åœæ­¢';
                        showToast('è‡ªå‹•åµæ¸¬å·²åœæ­¢');
                    }
                }
            } catch (e) {
                console.error('åˆ‡æ›æ’ç¨‹å™¨å¤±æ•—', e);
                switchEl.checked = !switchEl.checked;
                showToast('æ“ä½œå¤±æ•—');
            }
        }
        
        async function setDetectionInterval() {
            const interval = parseInt(document.getElementById('intervalInput').value);
            
            if (interval < 5 || interval > 300) {
                showToast('é–“éš”å¿…é ˆåœ¨ 5-300 ç§’ä¹‹é–“');
                return;
            }
            
            try {
                await fetch(`${API_BASE}/api/scheduler/interval`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ interval })
                });
                showToast(`åµæ¸¬é–“éš”å·²è¨­ç‚º ${interval} ç§’`);
            } catch (e) {
                console.error('è¨­å®šé–“éš”å¤±æ•—', e);
            }
        }
        
        // ========================================
        // å¸¸ç”¨ç‰©å“ç®¡ç†
        // ========================================
        
        const DEFAULT_QUICK_ITEMS = [
            { name: 'æ‰‹æ©Ÿ', icon: 'ğŸ“±', order: 1 },
            { name: 'é‘°åŒ™', icon: 'ğŸ”‘', order: 2 },
            { name: 'çœ¼é¡', icon: 'ğŸ‘“', order: 3 },
            { name: 'éŒ¢åŒ…', icon: 'ğŸ‘›', order: 4 },
            { name: 'è€³æ©Ÿ', icon: 'ğŸ§', order: 5 },
            { name: 'é™æ§å™¨', icon: 'ğŸ“º', order: 6 }
        ];
        
        function getQuickItems() {
            const saved = localStorage.getItem('quickItems');
            return saved ? JSON.parse(saved) : DEFAULT_QUICK_ITEMS;
        }
        
        function saveQuickItems(items) {
            localStorage.setItem('quickItems', JSON.stringify(items));
        }
        
        function loadQuickItems() {
            const items = getQuickItems();
            renderQuickItemsList(items);
        }
        
        function renderQuickItemsList(items) {
            const container = document.getElementById('quickItemsList');
            
            if (items.length === 0) {
                container.innerHTML = '<p style="color:#aaa;">å°šæœªè¨­å®šå¸¸ç”¨ç‰©å“</p>';
                return;
            }
            
            container.innerHTML = items.map(item => `
                <div class="class-tag" style="
                    display: inline-flex;
                    align-items: center;
                    gap: 8px;
                    background: rgba(255,215,0,0.2);
                    padding: 8px 12px;
                    border-radius: 20px;
                    font-size: 14px;
                ">
                    <span>${item.icon}</span>
                    <span style="color:#fff;">${item.name}</span>
                    <button onclick="removeQuickItem('${item.name}')" style="
                        background: rgba(245,87,108,0.5);
                        border: none;
                        color: #fff;
                        width: 20px;
                        height: 20px;
                        border-radius: 50%;
                        cursor: pointer;
                        font-size: 12px;
                    ">âœ•</button>
                </div>
            `).join('');
        }
        
        function addQuickItem() {
            const name = document.getElementById('newQuickItemName').value.trim();
            const icon = document.getElementById('newQuickItemIcon').value.trim() || 'ğŸ“¦';
            const order = parseInt(document.getElementById('newQuickItemOrder').value) || 1;
            
            if (!name) {
                alert('è«‹è¼¸å…¥ç‰©å“åç¨±');
                return;
            }
            
            const items = getQuickItems();
            
            // æª¢æŸ¥æ˜¯å¦å·²å­˜åœ¨
            if (items.find(i => i.name === name)) {
                showToast('ç‰©å“å·²å­˜åœ¨');
                return;
            }
            
            items.push({ name, icon, order });
            items.sort((a, b) => a.order - b.order);
            
            saveQuickItems(items);
            
            document.getElementById('newQuickItemName').value = '';
            document.getElementById('newQuickItemIcon').value = '';
            
            showToast(`å·²æ–°å¢: ${icon} ${name}`);
            loadQuickItems();
        }
        
        function removeQuickItem(name) {
            if (!confirm(`ç¢ºå®šè¦ç§»é™¤ã€Œ${name}ã€ï¼Ÿ`)) return;
            
            let items = getQuickItems();
            items = items.filter(i => i.name !== name);
            saveQuickItems(items);
            
            showToast(`å·²ç§»é™¤: ${name}`);
            loadQuickItems();
        }
        
        // åˆå§‹åŒ–
        loadConfig();
        loadAvailableCameras();
        loadClasses();
        loadSchedulerStatus();
        loadQuickItems();
    </script>
</body>
</html>
